webpackJsonp([20],{"2Cjf":function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=e("dBbz"),s={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{attrs:{id:"Document"}},[e("el-row",{attrs:{gutter:5}},[e("el-col",{attrs:{span:20}},[e("el-col",{attrs:{span:4,name:"docType"}},[e("el-button",{staticStyle:{display:"block",width:"130px"},attrs:{id:"docType-1"},on:{click:function(o){return t.chooseDocType("docType-1")}}},[t._v("产品listing文案")]),t._v(" "),e("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"docType-2"},on:{click:function(o){return t.chooseDocType("docType-2")}}},[t._v("产品定义文档")]),t._v(" "),e("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"docType-3"},on:{click:function(o){return t.chooseDocType("docType-3")}}},[t._v("认证文件")]),t._v(" "),e("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"docType-4"},on:{click:function(o){return t.chooseDocType("docType-4")}}},[t._v("结构文件")]),t._v(" "),e("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"docType-5"},on:{click:function(o){return t.chooseDocType("docType-5")}}},[t._v("立项资料")]),t._v(" "),e("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"docType-6"},on:{click:function(o){return t.chooseDocType("docType-6")}}},[t._v("申述文件")]),t._v(" "),e("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"docType-7"},on:{click:function(o){return t.chooseDocType("docType-7")}}},[t._v("其他")])],1),t._v(" "),e("el-col",{attrs:{span:16,name:"docList"}},[e("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{height:"auto"},attrs:{name:"files",multiple:"",limit:10,"on-exceed":t.uploadExceed,action:t.action,"before-upload":t.beforeUploadPicture,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-success":t.onSuccess,"on-error":t.uploadError,"file-list":t.fileList,"auto-upload":!1,data:t.params}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("选择文件")]),t._v(" "),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e("b",[t._v("请先选择要上传的文档,再确认上传,上传文档!")])])],1),t._v(" "),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(o){t.dialogVisible=o}}},[e("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)],1),t._v(" "),e("el-col",{staticStyle:{padding:"230px 0px 0px 0px"},attrs:{span:4,name:"option"}},[e("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.submitUpload}},[t._v("上传")]),t._v(" "),e("el-button",{attrs:{size:"small"},on:{click:t.download}},[t._v("下载")]),t._v(" "),e("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(o){t.deleteDialog=!0}}},[t._v("删除")])],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"需要删除以下文档",visible:t.deleteDialog,width:"80%"},on:{"update:visible":function(o){t.deleteDialog=o}}},[e("el-upload",{staticStyle:{height:"auto"},attrs:{action:t.action,"auto-upload":!1,"file-list":t.delShowDocList}}),t._v(" "),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(o){t.dialogVisible=o}}},[e("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(o){return t.delDocs(!1)}}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(o){return t.delDocs(!0)}}},[t._v("确定删除")])],1)],1)],1)},staticRenderFns:[]};var l=function(t){e("xaNJ")},c=e("VU/8")(i.a,s,!1,l,"data-v-f4a58448",null);o.default=c.exports},dBbz:function(t,o,e){"use strict";(function(t){o.a={name:"Document",data:function(){return{deleteDialog:!1,dialogVisible:!1,uploadComplete:!1,dialogImageUrl:"",params:{productId:0,typeId:1},fileType:"DOCUMENT",action:this.HOST+"/productFile/saveFiles",docTypeId:1,delShowDocList:[],delDocList:[],fileList:[]}},methods:{init:function(){console.log("doc init method"),this.buttonChecked("docType-1"),this.searchDocument(this.$store.state.product.productId,this.docTypeId)},searchDocument:function(t,o){var e=this;if(null==t||""==t)return this.$message("请先选择产品"),!1;this.fileList=[],this.delShowDocList=[],this.delDocList=[];var i={productId:t,typeId:o,fileType:this.fileType},s=this.URL_ROOT+this.URL_PREFIX+"/productFile/findByProductIdAndTypeId";this.$ajax({method:"get",url:s,params:i}).then(function(t){"200"==t.data.code&&(console.log(t.data),e.fileList=t.data.data)}).catch(function(t){console.error(t)})},uploadExceed:function(t,o){console.log("uploadExceed"),this.$message.warning("当前限制选择 10 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+o.length)+" 个文件")},handleRemove:function(t,o){console.log("移除文档"),console.log(t),this.delDocList.push(t.productDocumentId);var e={url:t.url,name:t.name,id:t.productDocumentId};this.delShowDocList.push(e),console.log(this.delDocList),console.log(this.delShowDocList)},handlePreview:function(t){console.log("图片预览"),console.log(t.url),console.log(t.name)},uploadError:function(t,o,e){this.$message.error("上传出错,请重新上传"+t)},onSuccess:function(t,o,e){console.log("文档上传成功后，后台返回文档的路径"),console.log(t.data),"200"==t.code&&(this.$message(t.msg),this.fileList=t.data),this.uploadComplete=!0},submitUpload:function(){console.log("提交"),this.$refs.upload.submit()},beforeUploadPicture:function(t){console.log("上传图片前调用方法"),console.log(t),this.params.productId=this.$store.state.product.productId},chooseDocType:function(t){console.log(t),this.buttonChecked(t);var o=parseInt(t.toString().split("-")[1]);console.log(o),this.params.typeId=o,this.docTypeId=o,this.searchDocument(this.$store.state.product.productId,this.docTypeId)},buttonChecked:function(o){t("#"+o).css("background-color","#409efb").css("color","#FFF"),t("#"+o).siblings().css("background-color","#FFF").css("color","#606266")},delDocs:function(t){var o=this;if(null==this.delDocList||0==this.delDocList.length)return this.$message.warning("请先选择需要删除的文档"),this.deleteDialog=!1,!1;if(this.deleteDialog=!0,console.log(this.delShowDocList.toString()),console.log(this.delDocList.toString()),t){var e=this.URL_ROOT+this.URL_PREFIX+"/productFile/dropFiles",i={fileIds:this.delDocList.toString(),fileType:this.fileType};console.log("需要删除的文档 类型 "),console.log(i.fileType),this.$ajax({method:"post",url:e,data:this.qs.stringify(i)}).then(function(t){"200"==t.data.code&&(console.log(t.data.data),o.fileList=t.data.data,o.$message.success("删除成功"))}).catch(function(t){console.log(t)})}else this.searchDocument(this.$store.state.product.productId,this.imgTypeId);this.delDocList=[],this.delShowDocList=[],this.deleteDialog=!1},download:function(){var t=this;console.log("download"),console.log(this.$refs.upload.uploadFiles),this.$confirm("确定下载？","提示",{confirmButtonText:"确定下载",cancelButtonText:"取消",type:"warning"}).then(function(){t.downloadDocment()})},downloadDocment:function(){var t=this,o=[],e=this.$refs.upload.uploadFiles;for(var i in e){var s=e[i].productDocumentId;o.push(s)}console.log(o);var l=this.URL_ROOT+this.URL_PREFIX+"/productFileDownload/zipDownload";this.$ajax.get(l,{params:{ids:o.toString(),type:this.fileType}}).then(function(o){200==o.status&&(open(o.request.responseURL),t.$message(o.data.data))}).catch(function(o){t.$message.error(o)})}}}}).call(o,e("5u2O"))},xaNJ:function(t,o){}});
//# sourceMappingURL=20.a0210f997fe109cec424.js.map