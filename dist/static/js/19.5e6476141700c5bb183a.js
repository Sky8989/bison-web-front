webpackJsonp([19],{"5ocB":function(t,e,o){"use strict";(function(t){e.a={name:"images",data:function(){return{multiple:!0,fileType:"IMAGE",deleteDialog:!1,delImgList:[],delShowImgList:[],imgTypeId:1,dialogImageUrl:"",dialogVisible:!1,params:{productId:0,typeId:1},imageUrl:"",action:this.URL_ROOT+this.URL_PREFIX+"/productFile/saveFiles",uploadComplete:!0,imgVisible:!1,photo:"",fileList:[]}},methods:{init:function(){console.log("img init method"),this.buttonChecked("imgType-1"),this.searchImg(this.$store.state.product.productId,this.imgTypeId)},searchImg:function(t,e){var o=this;if(this.fileList=[],this.delShowImgList=[],this.delImgList=[],null==t||""==t)return this.$message("请先选择产品"),!1;var i={productId:t,typeId:e,fileType:this.fileType};console.log(i.fileType);var s=this.URL_ROOT+this.URL_PREFIX+"/productFile/findByProductIdAndTypeId";this.$ajax({method:"get",url:s,params:i}).then(function(t){"200"==t.data.code&&(o.fileList=t.data.data)}).catch(function(t){console.error(t)})},submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(t,e){console.log("移除图片"),console.log(t),this.delImgList.push(t.productImgId);var o={url:t.url,id:t.productImgId};this.delShowImgList.push(o),console.log(this.delImgList),console.log(this.delShowImgList)},beforeUploadPicture:function(t){console.log("上传图片前调用方法"),console.log(t),this.params.productId=this.$store.state.product.productId},uploadError:function(t,e,o){t&&console.log(t.stack),this.$message.error("上传出错,请重新上传")},onSuccess:function(t,e,o){if(console.log("图片上传成功后，后台返回图片的路径"),console.log(o),"200"==t.code){var i=t.data;console.log(i),this.fileList=i,console.log(this.fileList)}this.uploadComplete=!0},handlePictureCardPreview:function(t){console.log("图片预览"),this.dialogImageUrl=t.url,this.dialogVisible=!0},uploadExceed:function(t,e){console.log("uploadExceed"),this.$message.warning("当前限制选择 10 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},chooseImgType:function(t){console.log(t);var e=parseInt(t.toString().split("-")[1]);console.log(e),this.buttonChecked(t),this.params.typeId=e,this.imgTypeId=e,this.searchImg(this.$store.state.product.productId,e)},buttonChecked:function(e){t("#"+e).css("background-color","#409efb").css("color","#FFF"),t("#"+e).siblings().css("background-color","#FFF").css("color","#606266")},delImgs:function(t){var e=this;if(console.log(this.delImgList),null==this.delImgList||0==this.delImgList.length)return this.$message.warning("请先选择需要删除的图片"),this.deleteDialog=!1,!1;if(this.deleteDialog=!0,console.log(this.delShowImgList.toString()),t){var o=this.URL_ROOT+this.URL_PREFIX+"/productFile/dropFiles",i={fileIds:this.delImgList.toString(),fileType:this.fileType};console.log("需要删除的图片 类型 "),console.log(i.fileType),this.$ajax({method:"post",url:o,data:this.qs.stringify(i)}).then(function(t){"200"==t.data.code&&(console.log(t.data.data),e.fileList=t.data.data,e.$message.success("删除成功"))}).catch(function(t){console.log(t)})}else this.searchImg(this.$store.state.product.productId,this.imgTypeId);this.delImgList=[],this.delShowImgList=[],this.deleteDialog=!1},download:function(){var t=this;console.log(this.$refs.upload.uploadFiles),this.$confirm("确定下载？,","提示",{confirmButtonText:"确定下载",cancelButtonText:"取消",type:"warning"}).then(function(){t.downloadIamge()})},downloadIamge:function(){var t=this,e=this.$refs.upload.uploadFiles,o=[];for(var i in e){var s=e[i].productImgId;o.push(s)}console.log(o);var l=this.URL_ROOT+this.URL_PREFIX+"/productFileDownload/zipDownload";this.$ajax.get(l,{params:{ids:o.toString(),type:this.fileType}}).then(function(e){console.log(e),console.log(e.request.responseURL),200==e.status&&(open(e.request.responseURL),t.$message(e.data.data))}).catch(function(e){t.$message.error(e)})}}}}).call(e,o("5u2O"))},O4GD:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("5ocB"),s={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("form",{attrs:{method:"post",target:"upload",action:"",encType:"multipart/form-data"}},[o("el-row",{attrs:{gutter:5}},[o("el-col",{attrs:{span:20}},[o("el-col",{attrs:{span:3,name:"imgType"}},[o("el-button",{staticStyle:{display:"block",width:"130px"},attrs:{id:"imgType-1"},on:{click:function(e){return t.chooseImgType("imgType-1")}}},[t._v("橱窗图")]),t._v(" "),o("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"imgType-2"},on:{click:function(e){return t.chooseImgType("imgType-2")}}},[t._v("EBC")]),t._v(" "),o("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"imgType-3"},on:{click:function(e){return t.chooseImgType("imgType-3")}}},[t._v("品牌推广图")]),t._v(" "),o("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"imgType-4"},on:{click:function(e){return t.chooseImgType("imgType-4")}}},[t._v("实物图")]),t._v(" "),o("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"imgType-5"},on:{click:function(e){return t.chooseImgType("imgType-5")}}},[t._v("包装图片")]),t._v(" "),o("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"imgType-6"},on:{click:function(e){return t.chooseImgType("imgType-6")}}},[t._v("说明书图片")]),t._v(" "),o("el-button",{staticStyle:{display:"block","margin-left":"0px",width:"130px"},attrs:{id:"imgType-7"},on:{click:function(e){return t.chooseImgType("imgType-7")}}},[t._v("其他")])],1),t._v(" "),o("el-col",{attrs:{span:16,name:"imgList"}},[o("div",{staticClass:"el-upload__tip"},[o("b",[t._v("请先选择要上传的图片,再确认上传,上传图片!")])]),t._v(" "),o("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{height:"auto"},attrs:{name:"files",multiple:"",limit:10,"on-exceed":t.uploadExceed,"before-upload":t.beforeUploadPicture,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-success":t.onSuccess,"on-error":t.uploadError,action:t.action,"auto-upload":!1,"file-list":t.fileList,data:t.params,"list-type":"picture-card"}},[o("i",{staticClass:"el-icon-plus"})]),t._v(" "),o("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)],1),t._v(" "),o("el-col",{staticStyle:{padding:"230px 0px 0px 0px"},attrs:{span:4,name:"option"}},[o("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.submitUpload}},[t._v("点击上传")]),t._v(" "),o("el-button",{attrs:{size:"small"},on:{click:t.download}},[t._v("下载")]),t._v(" "),o("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){t.deleteDialog=!0}}},[t._v("删除")])],1)],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"需要删除以下图片",visible:t.deleteDialog,width:"80%"},on:{"update:visible":function(e){t.deleteDialog=e}}},[o("el-upload",{staticStyle:{height:"auto"},attrs:{name:"file",multiple:"",limit:10,"on-exceed":t.uploadExceed,"on-remove":t.handleRemove,"on-success":t.onSuccess,action:t.action,"auto-upload":!1,"file-list":t.delShowImgList,"list-type":"picture-card"}}),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){return t.delImgs(!1)}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.delImgs(!0)}}},[t._v("确定删除")])],1)],1)],1)},staticRenderFns:[]};var l=function(t){o("tCG+")},a=o("VU/8")(i.a,s,!1,l,"data-v-73e32f90",null);e.default=a.exports},"tCG+":function(t,e){}});
//# sourceMappingURL=19.5e6476141700c5bb183a.js.map